\subsection{REST API Details}

In this section we report all the resources available via the REST API. In particular, we implemented via REST API, all the parts of the web application that allows the final user to look at the cars and the circuits and to make an order (the REST resources have been tested via the curl method).

\subsubsection*{User signup}

The following endpoint allows the user to signup in Wacar by passing the data to be inserted in the database using a JSON file.

\begin{itemize}
    \item URL: \texttt{/user/signup/}
    \item Method: \texttt{POST}
    \item URL Parameters: None
    \item Data Parameters: \\
    \textbf{Required}:\\
    Email= \{String\}\\
    Name = \{String\}\\
    Surname = \{String\}\\
    Address = \{String\}\\
    Password = \{String\}\\
    \item Success Response:\\
    \textbf{Code}: 200\\
    \textbf{Content}: New user in inserted into the database, login operation is performed and the user is redirected to the homepage\\
    \item Error Response:\\
    \textbf{Code}: -101 PASSWORD\_NOT\_COMPLIANT\\
    \textbf{Content}: {"error":{"code": -101, "message": "Password not compliant."}}\\
    \textbf{When}: The user is trying to register inserting a non compliant password\\
    \\
    \\
    \textbf{Code}: -102 MAIL\_NOT\_COMPLIANT\\
    \textbf{Content}: {"error":{"code": -102, "message": "Email not compliant."}}\\
    \textbf{When}: The user is trying to register inserting a non compliant email\\
    \\
    \\
    \textbf{Code}: -104 EMPTY\_INPUT\_FIELDS\\
    \textbf{Content}: {"error":{"code": -104, "message": "One or more input fields are empty."}}\\
    \textbf{When}: The user is trying to register without inseriting one or more mandatory fields\\
    \\
    \\
    \textbf{Code}: -108 MAIL\_ALREADY\_USED\\
    \textbf{Content}: {"error":{"code": -108, "message": "Email already used."}}\\
    \textbf{When}: The user is trying to register inserting a email already in the database\\
    \\
    \\
\end{itemize}


\subsubsection*{User login}

% the description of the resource

The following endpoint allows the user to login in Wacar

\begin{itemize}
    \item URL: \texttt{/user/login/}
    \item Method: \texttt{POST}
    \item URL Parameters: None
    \item Data Parameters: \\
    \textbf{Required}:\\
    Email= {String}\\
    Password = {String}\\
    \item Success Response:\\
    \textbf{Code}: 200\\
    \textbf{Content}: Login operation is performed, new session for the user is created and the user is redirected to the homepage\\
    \item Error Response:\\
    \textbf{Code}: -101 PASSWORD\_NOT\_COMPLIANT\\
    \textbf{Content}: {"error":{"code": -101, "message": "Password not compliant."}}\\
    \textbf{When}: The user is trying to login inserting a non compliant password\\
    \\
    \\
    \textbf{Code}: -102 MAIL\_NOT\_COMPLIANT\\
    \textbf{Content}: {"error":{"code": -102, "message": "Email not compliant."}}\\
    \textbf{When}: The user is trying to login inserting a non compliant email\\
    \\
    \\
    \textbf{Code}: -103 USER\_NOT\_EXISTS\\
    \textbf{Content}: {"error":{"code": -103, "message": "User does not exists."}}\\
    \textbf{When}: The user is trying to login inserting a email that is not in the database\\
    \\
    \\
    \textbf{Code}: -104 EMPTY\_INPUT\_FIELDS\\
    \textbf{Content}: {"error":{"code": -104, "message": "One or more input fields are empty."}}\\
    \textbf{When}: The user is trying to login without inserting one or more mandatory fields\\
    \\
    \\
    \textbf{Code}: -105 EMAIL\_MISSING\\
    \textbf{Content}: {"error":{"code": -105, "message": "Email missing."}}\\
    \textbf{When}: The user is trying to login without inserting the email field\\
    \\
    \\
    \textbf{Code}: -106 PASSWORD\_MISSING\\
    \textbf{Content}: {"error":{"code": -106, "message": "Password missing."}}\\
    \textbf{When}: The user is trying to login without inserting the password field\\
    \\
    \\
\end{itemize}

\subsection*{List circuits}

The following endpoint allows to list all the circuits (and returns a JSON).

\begin{itemize}
    \item URL: \texttt{/rest/circuit}
    \item Method: \texttt{GET}
    \item URL parameters: \texttt{None}
    \item Data parameters: \texttt{None}
    \item Success Response: \\
        \textbf{Code}: 200\\
        \textbf{Content}: The JSON corresponding to the list of circuits
        \texttt{INSERT JSON}
    \item Error Response:\\
    \textbf{Code}: 500 (internal code: E5A1)\\
    \textbf{Content}: The message containing the error (server error when retrieving the circuits)\\
    \begin{verbatim}
    {
        "message": {
        "message": "Cannot list circuit(s) : unexpected error.",
        "error-code": "E5A1"
    }}
    \end{verbatim}
    \item Error Response:\\
    \textbf{Code}: 500 (internal code: E5A1)\\
    \textbf{Content}: The message containing the error (server error when retrieving the circuits)\\
    \begin{verbatim}
    {
        "message": {
        "message": "Cannot list circuit(s) : unexpected database error.",
        "error-code": "E5A1"
        ”error-detail”: ”exception content”
    }}
    \end{verbatim}
    
\end{itemize}

\subsection*{Read order}

The following endpoint allows to retrieve a specific order given the id (and returns a JSON).

\begin{itemize}
	\item URL: \texttt{/rest/user/order/\{orderId\}}
	\item Method: \texttt{GET}
	\item URL parameters:
		\\\{orderId\} = the identifier number of the order to be retrieved.
	\item Data parameters: \texttt{None}
	\item Success Response: \\
	\textbf{Code}: 200\\
	\textbf{Content}: The JSON corresponding to the order:
	\\\begin{verbatim}
	{
		"order":{
				"id":1,
				"account":"default@example.com",
				"date":"2024-05-10",
				"carBrand":"Pagani",
				"carModel": "Zonda R",
				"circuit": "Autodromo Enzo e Dino Ferrari",
				"nLaps":3,
				"price":90,
				"createdAt":"2024-04-25 07:50:06.857"
			}
	}
	\end{verbatim}

	\item Error Response:\\
	\textbf{Code}: 401 (internal code: E4B3)\\
	\textbf{Content}: No authorization header sent by the client\\
	\begin{verbatim}
	{
		"message": {
			"message": "No authorization header sent by the client.",
			"error-code": "E4B3"
	}}
	\end{verbatim}	
	\item Error Response:\\
	\textbf{Code}: 401 (internal code: E4B3)\\
	\textbf{Content}: You are not authorized to perform this operation\\
	\begin{verbatim}
		{
			"message": {
				"message": "You are not authorized to perform this operation",
				"error-code": "E4B3"
		}}
	\end{verbatim}	
	\item Error Response:\\
	\textbf{Code}: 500 (internal code: E5A1)\\
	\textbf{Content}: The message containing the error (server error when retrieving the order)\\
	\begin{verbatim}
		{
			"message": {
				"message": "Cannot retrieve the order: unexpected error.",
				"error-code": "E5A1",
				”error-detail”: ”exception content”
		}}
	\end{verbatim}
	\item Error Response:\\
	\textbf{Code}: 500 (internal code: E5A1)\\
	\textbf{Content}: The message containing the error (server error when retrieving the circuits)\\
	\begin{verbatim}
		{
			"message": {
				"message": "Unable to serve the REST request.",
				"error-code": "E5A1",
				”error-detail”: ”exception content”
		}}
	\end{verbatim}
	
\end{itemize}
